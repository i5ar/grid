<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Isometric Grid Generator</title>
		<link rel="stylesheet" type="text/css" href="css/stylesheet.css" />
		<script type="text/javascript">

			const oElement = document.documentElement;
			const oCanvas = document.createElement('canvas');
			const oContext = oCanvas.getContext("2d");

			function updateGrid() {
				const gridSettingsElement = document.getElementById('settings');

				const cellHeightElement = gridSettingsElement['cell-height'];

				const lineWidthElement = gridSettingsElement['line-width'];
				const strokeStyleElement = gridSettingsElement['stroke-style'];

				const cellHeight = parseInt(cellHeightElement.value, 10);
				const cellWidth = cellHeight * 2;

				const lineWidth = parseInt(lineWidthElement.value, 10);

				const strokeStyle = strokeStyleElement.value;

				gridSettingsElement.querySelector("label[for='cell-height'] span").innerHTML = cellHeight;
				gridSettingsElement.querySelector("label[for='line-width'] span").innerHTML = lineWidth;
				gridSettingsElement.querySelector("label[for='stroke-style'] span").innerHTML = strokeStyle;

				oCanvas.setAttribute('width', cellWidth);
				oCanvas.setAttribute('height', cellHeight);

				oContext.clearRect(0, 0, cellWidth, cellHeight);

				oContext.strokeStyle = strokeStyle;
				oContext.lineWidth = lineWidth;

				oContext.beginPath();
				oContext.moveTo(cellWidth / 2, 0);
				oContext.lineTo(0, cellHeight / 2);
				oContext.lineTo(cellWidth / 2, cellHeight);
				oContext.lineTo(cellWidth, cellHeight / 2);
				oContext.lineTo(cellWidth / 2, 0);
				oContext.lineTo(cellWidth / 2, cellHeight);
				oContext.moveTo(cellWidth , 0);
				oContext.lineTo(cellWidth, cellHeight);
				oContext.moveTo(0 , 0);
				oContext.lineTo(0, cellHeight);
				oContext.stroke();

				oElement.style.backgroundImage = 'url("'+oCanvas.toDataURL()+'")';
			}

			function downloadCell() {
				const link = document.createElement('a');
				link.download = 'isometric.png';
				link.href = oCanvas.toDataURL()
				link.click();
			}

			function printGrid() {
				window.print();
			}
		</script>
	</head>
	<body onload="updateGrid();">
		<form id="settings">
			
			<label for="cell-height">cell height<span></span></label>
			<input type="range" id="cell-height" value="32" name="cell-height" min="10" max="200" oninput="updateGrid();" />
	
			<label for="line-width">line width<span></span></label>
			<input type="range" id="line-width" value="1" name="line-width" min="1" max="20" oninput="updateGrid();" />
		
			<label for="stroke-style">stroke style<span></span></label>
			<input type="color" id="stroke-style" value="#868686" name="stroke-style" oninput="updateGrid();" />

			<input type="button" value="download" onclick="downloadCell();" />

			<input type="button" value="print" onclick="printGrid();">

		</form>
	</body>
</html>